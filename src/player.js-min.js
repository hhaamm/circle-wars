if(typeof window=="undefined"){Entity=require("./entity.js");Pistol=require("./weapon.js").Pistol}var Player=function(b,e,d,c,a){this.x=b;this.y=e;this.direction=d;this.name=c;this.type="player";this.radius=10;this.life=100;this.keyboard=a;this.DIRECTION_UP=90*Math.PI/180;this.DIRECTION_DOWN=270*Math.PI/180;this.DIRECTION_LEFT=180*Math.PI/180;this.DIRECTION_RIGHT=0;this.weapon=null;this.basicWeapon=new Pistol();this.hit=function(f){this.life-=f;if(this.life<=0){this.game.removeEntity(this);this.life=0;if(console){console.log("Game over")}}};this.draw=function(f){f.fillStyle="#00A308";f.beginPath();f.arc(this.x,this.y,this.radius,0,Math.PI*2,true);f.closePath();f.fill()};this.shoot=function(){this.getWeapon().shoot(this);if(this.getWeapon().bullets===0){this.weapon=null}};this.getWeapon=function(){if(this.weapon){return this.weapon}else{return this.basicWeapon}};this.addWeapon=function(f){this.weapon=f};this.onKeyDown=function(g){switch(g.keyCode){case this.keyboard.left:if(this.canMove(this.x-10,this.y)){this.x-=10}this.direction=this.DIRECTION_LEFT;break;case this.keyboard.right:if(this.canMove(this.x+10,this.y)){this.x+=10}this.direction=this.DIRECTION_RIGHT;break;case this.keyboard.forward:if(this.canMove(this.x,this.y-10)){this.y-=10+this.direction}this.direction=this.DIRECTION_UP;break;case this.keyboard.backward:if(this.canMove(this.x,this.y+10)){this.y+=10+this.direction}this.direction=this.DIRECTION_DOWN;break;case this.keyboard.shoot:this.shoot();break}var f=this;$(this.game.entities).each(function(j,h){if(h.type=="weapon"&&f.hitTest(h)){debug("Picked up weapon");if(f.game.isClient){f.game.trigger("weapon taken",{id:h.id,playerId:f.id})}f.game.removeEntity(h);f.addWeapon(h)}})};this.onKeyUp=function(f){};this.canMove=function(g,i){var f=this;var h=true;$(this.game.entities).each(function(k,j){if(j.type=="player"){}if(j.type=="wall"){if(f.hitTest(j,g,i)){h=false}}});return h};this.getX=function(){return this.x};this.getY=function(){return this.y}};Player.prototype=new Entity();if(typeof window=="undefined"){module.exports=Player};